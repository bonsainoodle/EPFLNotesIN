\documentclass[a4paper]{article}

% Expanded on 2021-12-01 at 15:14:59.

\usepackage{../../style}

\title{AICC 1}
\author{Joachim Favre}
\date{Mercredi 01 d√©cembre 2021}

\begin{document}
\maketitle

\lecture{22}{2021-12-01}{Closed forms of recurrence relations}{
}

\subsection{Solving recurrence relations}

\subsubsection{Linear homogeneous recurrence relations with constant coefficients}

\parag{Definition}{
    A \important{linear homogeneous recurrence relation of degree $k$ with constant coefficients} is a recurrence relation of the form
    \[a_n = c_1 a_{n-1} + c_2 a_{n-2} + \ldots + c_k a_{n-k}\]
    where $c_1, \ldots, c_k$ are real numbers and $c_k \neq 0$.
}

\parag{Theorem}{
Let $c_1$ and $c_2$ be real numbers. Moreover, let's suppose that $r^2 - c_1r - c_2$ has two \textit{distinct} roots $r_1$ and $r_2$.

The sequence $\left\{a_n\right\}$ is a solution to the recurrence relation $a_n = c_1 a_{n-1} + c_2 a_{n-2}$ if and only if:
\[a_n = \alpha_1 r_1^{n} + \alpha_2 r_2^{n}, \mathspace n = 0, 1, 2, \ldots\]
where $\alpha_1$ and $\alpha_2$ are constants.

\subparag{Note}{
    $\alpha_1$ and $\alpha_2$ depend on the initial conditions.
}

}

\parag{Theorem (degree 2 with repeated roots)}{
Let $c_1$ and $c_2$ be real numbers with $c_2 \neq 0$. Suppose that $r^2 - c_1 r - c_2 = 0$ has one repeated root $r_0$.

The sequence $\left\{a_n\right\}$ is a solution to the recurrence relation $a_n = c_1 a_{n-1} + c_2 a_{n-2}$ if and only if:
\[a_n = \alpha_1 r_0^{n} + \alpha_2 n r_0^{n} \]
where $\alpha_1$ and $\alpha_2$ are constants.
}

\parag{Theorem}{
    Let $c_1, \ldots, c_k$ be real numbers. Let's suppose that the characteristic equation $r^k - c_1 r^{k-1} - \ldots - c_k = 0$ has $k$ distinct roots $r_1, \ldots, r_k$.

    Then, a sequence $\left\{a_n\right\}$ is a solution of the recurrence relation $a_n = c_1 a_{n-1} + \ldots + c_k a_{n-k}$ if and only if $a_n$ is of the form:
    \[a_n = \alpha_1 r_1^n + \alpha_2 r_2^n + \ldots + \alpha_k r_k^n, \mathspace n = 0, 1, 2, \ldots\]
    where $\alpha_1, \ldots, \alpha_k$ are constants.
}

\parag{Theorem}{
    Let $c_1, \ldots, c_k$ be real numbers. Let's suppose that the characteristic equation $r^k - c_1 r^{k-1} - \ldots - c_k = 0$ has $t$ distinct roots $r_1, \ldots, r_t$, with multiplicities $m_1, \ldots, m_t$ respectively.

    Then, a sequence $\left\{a_n\right\}$ is a solution of the recurrence relation $a_n = c_1 a_{n-1} + \ldots + c_k a_{n-k}$ if and only if $a_n$ is of the form:

    \begin{multiequality}
        a_n =\ & \left(\alpha_{1, 0} + a_{1,1}n + \ldots + \alpha_{1,m_1 - 1}n^{m_1 - 1}\right)r_1^n \\
        & + \left(\alpha_{2, 0} + a_{2,1}n + \ldots + \alpha_{2,m_2 - 1}n^{m_2 - 1}\right)r_2^n \\
        & + \ldots \\
        & + \left(\alpha_{t, 0} + a_{t,1}n + \ldots + \alpha_{t,m_t - 1}n^{m_t - 1}\right)r_t^n
    \end{multiequality}
}

% \subsubsection{Generating functions}
% \parag{Definition}{
%     The \important{generating function} for the infinite sequence $a_0, \ldots, a_k, \ldots$ of real numbers is the infinite series 
%     \[G\left(x\right) = a_0 + a_1 x + \ldots + a_k x^k + \ldots = \sum_{k=0}^{\infty} a_k x^k\]

%     \subparag{Examples}{
%         The sequence $\left\{a_k\right\}$ with $a_k = k+1$ has the generating function: 
%         \[\sum_{k=0}^{\infty} \left(k+1\right)x^k\]

%         Similarly, if $a_k = 2^k$, then the generating function is given by: 
%         \[\sum_{k=0}^{\infty} 2^k x^k\]
%     }
% }

% \parag{Remarkable generating functions}{
%     We know the closed form of the following generating functions: 

%     \begin{center}
%     \begin{tabular}{|c|c|}
%         \hline
%         \fullbf{$a_k$} & \fullbf{Its generating function} \\
%         \hline
%         $\displaystyle C\left(n, k\right)$ & $\displaystyle G\left(x\right) = \left(1 + x\right)^n = \sum_{k=0}^{\infty} \binom{n}{k} x^k$ \\
%         \hline
%         $\displaystyle a^n$ & $\displaystyle G\left(x\right) = \frac{1}{1 - ax} = \sum_{k=0}^{\infty} a^k x^k$ \\
%         \hline
%         $\displaystyle C\left(n + k - 1, k\right)$ & $\displaystyle \displaystyle G\left(x\right) = \frac{1}{\left(1 - x\right)^n} = \sum_{k=0}^{\infty} \binom{n+k-1}{k} x^k$ \\
%         \hline
%     \end{tabular}
%     \end{center}

%     We'll generalise binomial coefficients in the next lesson, we only need to know that $C\left(n, r\right) = 0$ when $r \geq n$.

% }

% \parag{Using generating functions}{
%     Let's say we want to solve the recurrence relation $a_k = 3a_{k-1}$ with initial condition $a_0 = 2$, using generating functions.

%     We have: 
%     \[G\left(x\right) = \sum_{k=0}^{\infty} a_k x^k = a_0 + \sum_{k=1}^{\infty} a_k x^k = a_0 + \sum_{k=1}^{\infty} 3a_{k-1}x^k =a_0 + 3x\sum_{k=1}^{\infty} a_{k-1}x^{k-1}\]

%     Changing the index, taking $k-1 \to k$, we get:
%     \[G\left(x\right) = a_0 + 3x \sum_{k=0}^{\infty} a_k x^k = a_0 + 3xG\left(x\right)\]

%     So, we can solve the equation: 
%     \[G\left(x\right) = a_0 + 3xG\left(x\right) \iff G\left(x\right) = \frac{2}{1 - 3x} = 2\cdot \sum_{k=0}^{\infty} 3^k x^k = \sum_{k=0}^{\infty} 2\cdot 3^k x^k\]

%     We can see that, in the generating function, we have $a_k = 2\cdot 3^k$. We could have solved this much simpler by ``seeing it'', or by using the method previously explained, but the point is that, now, we know how it works.
% }

% \parag{Solving Hanoi Tower}{
%     When we wanted to solve our Hanoi Tower problem, we had found $H_n = 2H_{n-1} + 1$ and $H_0 = 0$. This is not homogeneous, so let's use generating functions: 
%     \[G\left(x\right) = \sum_{k=0}^{\infty} H_k x^k = \underbrace{H_0}_{=0} + \sum_{k=1}^{\infty} H_{k} x^k = \sum_{k=1}^{\infty} \left(2 H_{k - 1} + 1\right)x^k \]

%     Let us split this function and then do the regular ``factoring out-change of index trick'': 
%     \[G\left(x\right) = \sum_{k=1}^{\infty} 2H_{k-1} x^k + \sum_{k=1}^{\infty} x^k = 2x \sum_{k=1}^{\infty} H_{k-1} x^{k-1} + x \sum_{k=1}^{\infty} x^{k-1} = 2x \sum_{k=0}^{\infty} H_k x^k + x\sum_{k = 0}^{\infty} x^k\]

%     We can now recognise our generating function, and one of the remarkable ones: 
%     \[G\left(x\right) = 2x G\left(x\right) + x \frac{1}{1-x} \implies G\left(x\right) = \frac{x}{\left(1 - 2x\right)\left(1 - x\right)}\]

%     Let us use partial fractions to split this fraction: 
%     \[G\left(x\right) = \frac{x}{\left(1 - 2x\right)\left(1 - x\right)} = \frac{a}{1 - 2x} + \frac{b}{1 - x} = \frac{a\left(1 - x\right) + b\left(1 - 2x\right)}{\left(1 - 2x\right)\left(1 - x\right)}\]

%     So, we need to solve the following equation: 
%     \[x = a\left(1 -x\right) + b\left(1 - 2x\right) = a - ax + b - 2bx \iff \left(a + b\right) + x\left(-1 - a - b\right) = 0\]

%     Thus we have the following system to solve: 
%     \begin{systemofequations}{}
%     &\ a + b = 0 \\
%     &\ -1 - a - b = 0
%     \end{systemofequations}

%     Solving it, we find: 
%     \[a = 1, \mathspace b = -1\]

%     Coming back to our generating function, we have: 
%     \[G\left(x\right) = \frac{a}{1 - 2x} + \frac{b}{1 - x} = \frac{1}{1-2x} - \frac{1}{1-x} = \sum_{k=0}^{\infty} 2^k x^k - \sum_{k=0}^{\infty} x^k = \sum_{k=0}^{\infty} \left(2^k -  1\right)x^k\]

%     So, we have found $a_n = 2^n - 1$
% }

% \parag{General method}{
%     \begin{itemize}[left=0pt]
%         \item Define the generating function $G\left(x\right)$.
%         \item Use the recurrence relation to derive an alternative expression for $G\left(x\right)$ (using the ``factoring out-change of index'' trick).
%         \item Solve the equation for $G\left(x\right)$. 
%         \item If it is a fraction of polynomial, use partial fractions to split it as a sum of terms of the form $\frac{c_i}{x - r_i}$ (it is always possible if the degree of the numerator is less than the one of the denominator). 
%         \item Determine the power expansion of $G\left(x\right)$, using remarkable generating functions or Taylor series (we have never used Taylor series and we will probably never use them, but I put them here because it would be a valid method if one forgot the remarkable generating functions).
%     \end{itemize}
% }

\end{document}
